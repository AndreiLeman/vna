CXX = @CXX@ @CXXFLAGS@
LDFLAGS = @LDFLAGS@
EXTRA_LIBRARIES = @EXTRA_LIBRARIES@

INSTALL_BINDIR = @prefix@@bindir@
INSTALL_LIBDIR = @prefix@@libdir@
INSTALL_INCLUDEDIR = @prefix@@includedir@

all: vna_main

lib/libxavna.so: libxavna/xavna.C libxavna/xavna_cpp.C libxavna/platform_abstraction.C libxavna/calibration.C
	$(CXX) --shared $^ -o $@ $(LDFLAGS) -lpthread

vna_main: vna_main.C vna.glade.c vna_ui_core.C lib/libxavna.so
	$(CXX) vna_main.C vna.glade.c vna_ui_core.C -Iinclude -Llib -lxavna -o $@ $(LDFLAGS) @GTK_CFLAGS@ @GTK_LIBS@ @FFTW_CFLAGS@ @FFTW_LIBS@ -lpthread

vna.glade.c: vna.glade
	xxd -i vna.glade > $@

install: vna_main
	# binaries
	install vna_main $(INSTALL_BINDIR)/

clean:
	rm -f *.so vna_main *.glade.c
